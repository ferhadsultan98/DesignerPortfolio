<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Портфолио Дизайнера</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <style>
        /* Общие стили */
        body {
            margin: 0;
            font-family: 'Manrope', sans-serif;
            background-color: #121212; /* Темный фон */
            color: #e0e0e0; /* Светлый текст */
            overflow-x: hidden; /* Предотвращаем горизонтальную прокрутку */
            scroll-behavior: smooth;
        }

        * {
            box-sizing: border-box;
        }

        /* Стили для контейнера с 3D фоном */
        .background3dShapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Позади всего контента */
            overflow: hidden;
        }

        .shape {
            position: absolute;
            border-radius: 10px;
            opacity: 0.1; /* Полупрозрачные */
        }

        .shape1 {
            width: 150px;
            height: 150px;
            background: linear-gradient(45deg, #6a0dad, #0077b6); /* Фиолетово-синий */
            top: 10%;
            left: 5%;
            animation: animateShape 20s infinite linear alternate;
        }

        .shape2 {
            width: 200px;
            height: 200px;
            background: linear-gradient(45deg, #00b4d8, #48cae4); /* Голубой */
            bottom: 15%;
            right: 10%;
            animation: animateShape 25s infinite linear alternate-reverse;
        }

        .shape3 {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #ff006e, #ff70a6); /* Розовый */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: animateShape 15s infinite linear alternate;
        }
        
        .shape4 {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #fca311, #ffb703); /* Оранжево-желтый */
            top: 20%;
            right: 20%;
            animation: animateShape 18s infinite linear alternate-reverse;
        }


        @keyframes animateShape {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg) scale(1);
            }
            50% {
                transform: translateY(50px) translateX(30px) rotate(180deg) scale(1.1);
            }
            100% {
                transform: translateY(-20px) translateX(-40px) rotate(360deg) scale(0.9);
            }
        }

        /* Стили для хедера */
        .mainHeader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000; /* Поверх всего */
            background-color: rgba(18, 18, 18, 0.8); /* Полупрозрачный фон для хедера */
            backdrop-filter: blur(10px);
            transition: background-color 0.3s ease;
        }

        .logoContainer .logoText {
            font-family: 'Playfair Display', serif;
            font-size: 28px;
            font-weight: 700;
            color: #ffffff;
            text-decoration: none;
        }
        
        .mainNavigation ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .mainNavigation li {
            margin-left: 30px;
            position: relative; /* Для выпадающего меню */
        }

        .mainNavigation a {
            text-decoration: none;
            color: #e0e0e0;
            font-size: 16px;
            font-weight: 500;
            padding: 10px 0;
            position: relative;
            transition: color 0.3s ease;
        }

        .mainNavigation a:hover {
            color: #00b4d8; /* Акцентный цвет при наведении */
        }

        .mainNavigation a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: #00b4d8;
            transition: width 0.3s ease;
        }

        .mainNavigation a:hover::after {
            width: 100%;
        }
        
        /* Стили для выпадающего меню */
        .dropdownMenu {
            display: none; /* Скрыто по умолчанию */
            position: absolute;
            top: 100%; /* Появляется под родительским элементом */
            left: 0;
            background-color: #2a2a2a; /* Фон выпадающего меню */
            border-radius: 5px;
            padding: 10px 0;
            min-width: 180px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 1001;
        }

        .hasDropdown:hover .dropdownMenu,
        .hasDropdown.open .dropdownMenu { /* Показываем при наведении или при классе open */
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .dropdownMenu a {
            display: block;
            padding: 10px 20px;
            color: #e0e0e0;
            font-size: 15px;
        }
        
        .dropdownMenu a::after { /* Убираем подчеркивание для ссылок в дропдауне */
            display: none;
        }

        .dropdownMenu a:hover {
            background-color: #00b4d8;
            color: #121212;
        }
        
        .menuToggle { /* Для мобильного меню */
            display: none;
            color: #e0e0e0;
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
        }

        /* Основной контейнер для страниц */
        .pageWrapper {
            perspective: 1000px; /* Для 3D эффекта */
        }

        /* Стили для секций (страниц) */
        .pageSection {
            height: 100vh; /* Каждая секция занимает всю высоту экрана */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 50px; /* Учитываем высоту хедера */
            position: sticky;
            top: 0;
            background-color: #1a1a1a; /* Немного светлее основного фона для видимости наложения */
            box-shadow: 0 -10px 30px rgba(0,0,0,0.3); /* Тень для эффекта глубины */
            transition: transform 0.7s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.7s ease;
            will-change: transform, opacity; /* Оптимизация производительности */
            overflow: hidden; /* Скрываем контент, выходящий за пределы секции */
        }

        /* Первая секция не должна быть sticky, чтобы остальные могли "наезжать" на нее */
        .pageSection:first-child {
            position: relative; 
            z-index: 1; /* Начальный z-index */
        }
        
        /* Стили для контента внутри секций */
        .sectionContent {
            max-width: 900px;
            text-align: center;
            animation: fadeInContent 1s ease-out forwards;
            opacity: 0;
            transform: translateY(30px);
        }
        
        .pageSection.isActive .sectionContent { /* Анимация при активации секции */
             opacity: 1;
             transform: translateY(0);
             transition: opacity 0.5s ease 0.3s, transform 0.5s ease 0.3s; /* Задержка для анимации */
        }


        @keyframes fadeInContent {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .pageSection h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            margin-bottom: 20px;
            color: #ffffff;
            line-height: 1.2;
        }
        
        .pageSection h2 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            margin-bottom: 20px;
            color: #00b4d8; /* Акцентный цвет для подзаголовков */
        }

        .pageSection p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 30px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Стили для кнопок */
        .customButton {
            display: inline-block;
            padding: 15px 35px;
            background-color: #00b4d8; /* Акцентный цвет */
            color: #121212; /* Темный текст на светлой кнопке */
            text-decoration: none;
            font-weight: 700;
            font-size: 1rem;
            border-radius: 50px; /* Скругленные углы */
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .customButton:hover {
            transform: translateY(-5px) scale(1.05);
            background-color: #0096c7; /* Немного темнее при наведении */
            box-shadow: 0 10px 20px rgba(0, 180, 216, 0.3);
        }
        
        .customButton.outline {
            background-color: transparent;
            color: #00b4d8;
            border: 2px solid #00b4d8;
        }
        
        .customButton.outline:hover {
            background-color: #00b4d8;
            color: #121212;
        }
        
        /* Параллакс элементы внутри секций */
        .parallaxElement {
            transition: transform 0.5s ease-out; /* Плавность для параллакса */
        }

        /* Дизайн секций */
        #hero {
            background: linear-gradient(rgba(18, 18, 18, 0.7), rgba(18, 18, 18, 0.9)), url('https://source.unsplash.com/random/1600x900/?abstract,dark,design') no-repeat center center/cover;
            z-index: 5; /* Выше чем обычные секции */
        }
        
        #about { background-color: #1f1f1f; z-index: 4; }
        #portfolio { background-color: #242424; z-index: 3; }
        #contact { background-color: #1c1c1c; z-index: 2; }

        /* Стили для сетки портфолио */
        .portfolioGrid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            width: 100%;
        }

        .portfolioItem {
            background-color: #2a2a2a;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .portfolioItem:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }

        .portfolioItem img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }

        .portfolioItemContent {
            padding: 20px;
        }
        
        .portfolioItemContent h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: #00b4d8;
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .portfolioItemContent p {
            font-size: 0.9rem;
            margin-bottom: 0;
            line-height: 1.6;
        }
        
        /* Стили для формы контактов */
        .contactForm {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 600px;
        }
        
        .contactForm input,
        .contactForm textarea {
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #444;
            background-color: #2a2a2a;
            color: #e0e0e0;
            font-size: 1rem;
            font-family: 'Manrope', sans-serif;
        }
        
        .contactForm input::placeholder,
        .contactForm textarea::placeholder {
            color: #888;
        }
        
        .contactForm textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .contactForm button {
            align-self: flex-start; /* Кнопка не растягивается на всю ширину */
        }
        
        /* Футер */
        .mainFooter {
            padding: 30px 50px;
            text-align: center;
            background-color: #0f0f0f;
            color: #aaa;
            font-size: 0.9rem;
        }
        
        .socialIcons a {
            color: #aaa;
            margin: 0 10px;
            font-size: 1.5rem;
            transition: color 0.3s ease;
        }
        
        .socialIcons a:hover {
            color: #00b4d8;
        }


        /* Адаптивность */
        @media (max-width: 768px) {
            .mainHeader {
                padding: 15px 20px;
            }

            .mainNavigation {
                display: none; /* Скрываем навигацию */
                position: absolute;
                top: 100%; /* Под хедером */
                left: 0;
                width: 100%;
                background-color: rgba(18, 18, 18, 0.95);
                flex-direction: column;
                align-items: center;
                padding: 20px 0;
            }
            
            .mainNavigation.isActive { /* Показываем, если есть класс isActive */
                display: flex;
            }

            .mainNavigation li {
                margin-left: 0;
                margin-bottom: 15px;
                width: 100%;
                text-align: center;
            }
            
            .mainNavigation a {
                font-size: 18px;
            }
            
            .dropdownMenu { /* Выпадающее меню на мобильных */
                position: static; /* Меняем позиционирование */
                background-color: transparent;
                box-shadow: none;
                padding-left: 20px; /* Отступ для вложенности */
            }
            
            .dropdownMenu a {
                 padding: 8px 20px;
            }

            .menuToggle {
                display: block; /* Показываем кнопку меню */
            }

            .pageSection h1 {
                font-size: 2.5rem;
            }
            
            .pageSection h2 {
                font-size: 2rem;
            }

            .pageSection p {
                font-size: 1rem;
            }
            
            .portfolioGrid {
                grid-template-columns: 1fr; /* Один столбец на мобильных */
            }
            
            .shape {
                opacity: 0.05; /* Менее навязчивый фон на мобильных */
            }
            .shape1 { width: 100px; height: 100px; }
            .shape2 { width: 120px; height: 120px; }
            .shape3 { width: 80px; height: 80px; }
        }

    </style>
</head>
<body>

    <div class="background3dShapes">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
        <div class="shape shape4"></div>
    </div>

    <header class="mainHeader">
        <div class="logoContainer">
            <a href="#hero" class="logoText">Дизайнер</a>
        </div>
        <button class="menuToggle" id="menuToggle" aria-label="Открыть меню">
            <i class="fas fa-bars"></i>
        </button>
        <nav class="mainNavigation" id="mainNav">
            <ul>
                <li><a href="#hero">Главная</a></li>
                <li><a href="#about">Обо мне</a></li>
                <li class="hasDropdown">
                    <a href="#portfolio">Портфолио <i class="fas fa-chevron-down fa-xs"></i></a>
                    <ul class="dropdownMenu">
                        <li><a href="#portfolio-web">Веб-дизайн</a></li>
                        <li><a href="#portfolio-branding">Брендинг</a></li>
                        <li><a href="#portfolio-motion">Моушн</a></li>
                    </ul>
                </li>
                <li><a href="#contact">Контакты</a></li>
            </ul>
        </nav>
    </header>

    <div class="pageWrapper">
        <section id="hero" class="pageSection">
            <div class="sectionContent">
                <h1 class="parallaxElement" data-parallax-speed="0.2">Имя Фамилия</h1>
                <p class="parallaxElement" data-parallax-speed="0.1">Креативный дизайнер | UI/UX Специалист | Визуализатор идей</p>
                <a href="#portfolio" class="customButton parallaxElement" data-parallax-speed="0.05">Смотреть работы</a>
            </div>
        </section>

        <section id="about" class="pageSection">
            <div class="sectionContent">
                <h2>Обо мне</h2>
                <p class="parallaxElement" data-parallax-speed="0.1">Привет! Я [Ваше Имя], дизайнер из [Ваш Город/Страна]. Моя страсть — создавать не только красивые, но и функциональные интерфейсы, которые решают задачи пользователей и бизнеса. Я верю в силу минимализма, продуманной типографики и интуитивно понятного взаимодействия.</p>
                <p class="parallaxElement" data-parallax-speed="0.05">Опыт работы более X лет в сферах веб-дизайна, мобильных приложений и брендинга. Всегда в поиске новых вызовов и интересных проектов!</p>
                <a href="#contact" class="customButton outline parallaxElement" data-parallax-speed="0.05">Связаться со мной</a>
            </div>
        </section>

        <section id="portfolio" class="pageSection">
            <div class="sectionContent" style="max-width: 1200px;"> <h2>Мои Работы</h2>
                <div class="portfolioGrid">
                    <div class="portfolioItem parallaxElement" data-parallax-speed="0.1">
                        <img src="https://source.unsplash.com/random/400x300/?website,design" alt="Проект 1">
                        <div class="portfolioItemContent">
                            <h3>Проект "Альфа"</h3>
                            <p>Разработка дизайна для корпоративного веб-сайта.</p>
                        </div>
                    </div>
                    <div class="portfolioItem parallaxElement" data-parallax-speed="0.15">
                        <img src="https://source.unsplash.com/random/400x300/?app,interface" alt="Проект 2">
                        <div class="portfolioItemContent">
                            <h3>Мобильное приложение "Бета"</h3>
                            <p>UI/UX дизайн для iOS и Android приложения.</p>
                        </div>
                    </div>
                    <div class="portfolioItem parallaxElement" data-parallax-speed="0.1">
                        <img src="https://source.unsplash.com/random/400x300/?branding,logo" alt="Проект 3">
                        <div class="portfolioItemContent">
                            <h3>Брендинг "Гамма"</h3>
                            <p>Создание фирменного стиля и логотипа.</p>
                        </div>
                    </div>
                     <div class="portfolioItem parallaxElement" data-parallax-speed="0.15">
                        <img src="https://source.unsplash.com/random/400x300/?dashboard,ui" alt="Проект 4">
                        <div class="portfolioItemContent">
                            <h3>Интерфейс "Дельта"</h3>
                            <p>Дизайн аналитической панели управления.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="pageSection">
            <div class="sectionContent">
                <h2>Свяжитесь со мной</h2>
                <p class="parallaxElement" data-parallax-speed="0.1">Есть интересный проект или просто хотите сказать привет? Не стесняйтесь писать!</p>
                <form class="contactForm parallaxElement" data-parallax-speed="0.05">
                    <input type="text" name="name" placeholder="Ваше имя" required>
                    <input type="email" name="email" placeholder="Ваш Email" required>
                    <textarea name="message" placeholder="Ваше сообщение" required></textarea>
                    <button type="submit" class="customButton">Отправить сообщение <i class="fas fa-paper-plane fa-sm"></i></button>
                </form>
            </div>
        </section>
    </div>

    <footer class="mainFooter">
        <div class="socialIcons">
            <a href="#" aria-label="Behance"><i class="fab fa-behance"></i></a>
            <a href="#" aria-label="Dribbble"><i class="fab fa-dribbble"></i></a>
            <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
            <a href="#" aria-label="Telegram"><i class="fab fa-telegram-plane"></i></a>
        </div>
        <p>&copy; <span id="currentYear"></span> Ваше Имя. Все права защищены.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.pageSection');
            const header = document.querySelector('.mainHeader');
            const mainNav = document.getElementById('mainNav');
            const menuToggle = document.getElementById('menuToggle');
            const parallaxElements = document.querySelectorAll('.parallaxElement');
            const dropdowns = document.querySelectorAll('.hasDropdown');

            // Установка текущего года в футере
            document.getElementById('currentYear').textContent = new Date().getFullYear();

            // --- Эффект наложения страниц при прокрутке и активация секций ---
            // Этот эффект более сложен для чистого 3D "наезда" без JS-манипуляций с transform.
            // Здесь используется position:sticky, что создает базовый эффект наложения.
            // Для более выраженного 3D эффекта (уменьшение предыдущей секции и т.д.)
            // потребовался бы более сложный JS для отслеживания scroll-прогресса внутри каждой секции.
            // Этот базовый вариант фокусируется на активации контента.

            let lastScrollTop = 0;

            function handleScroll() {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

                // Эффект для хедера (изменение фона при скролле)
                if (scrollTop > 50) {
                    header.style.backgroundColor = 'rgba(18, 18, 18, 0.95)';
                } else {
                    header.style.backgroundColor = 'rgba(18, 18, 18, 0.8)';
                }

                // Активация секций и параллакс
                sections.forEach((section, index) => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;
                    const scrollPosition = scrollTop + window.innerHeight / 2; // Активация по центру экрана

                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        if (!section.classList.contains('isActive')) {
                            section.classList.add('isActive');
                        }
                    } else {
                         // Можно добавить деактивацию, если нужно (section.classList.remove('isActive');)
                         // но для эффекта "проявления" это может быть не нужно.
                    }

                    // Простой параллакс для элементов внутри видимой части секции
                    // Этот параллакс будет срабатывать для элементов внутри всего документа,
                    // для более точного, привязанного к видимости секции, нужна доп. логика.
                    const parallaxSpeed = parseFloat(section.dataset.parallaxSpeed || 0);
                    if (parallaxSpeed) { // Если у самой секции есть data-parallax-speed
                         section.style.transform = `translateY(${ (scrollTop - sectionTop) * parallaxSpeed }px)`;
                    }
                });
                
                // Параллакс для отдельных элементов
                parallaxElements.forEach(el => {
                    const speed = parseFloat(el.dataset.parallaxSpeed) || 0.1;
                    // Расчет смещения относительно центра элемента или верха окна
                    const rect = el.getBoundingClientRect();
                    // Простой эффект: двигаем элемент медленнее, чем скролл
                    // Более сложный эффект потребует расчета относительно "центра" видимой области элемента
                    const elementScrollEffect = (scrollTop - (el.offsetTop - window.innerHeight / 2)) * speed * 0.5;
                     // el.style.transform = `translateY(${elementScrollEffect}px)`; // Этот вариант может конфликтовать с анимацией fadeInContent

                    // Более простой вариант для параллакса на основе положения элемента в окне:
                    const movement = -(rect.top * speed * 0.1); // Можно настроить множитель
                    if (rect.top < window.innerHeight && rect.bottom > 0) { // Если элемент в видимой области
                        // Убедимся, что не перезаписываем transform от fadeInContent не вовремя
                        if (el.closest('.pageSection').classList.contains('isActive')) {
                           // el.style.transform = `translateY(${movement}px)`; // Аккуратно! Может конфликтовать
                        }
                    }
                });


                // --- Начало логики для "наезда" секций ---
                // Эта часть более сложная и требует точной настройки
                // Для настоящего 3D-эффекта (одна страница уходит "вглубь" под другую)
                // нужно изменять transform (scale, translateZ) предыдущих секций.
                // CSS 'position: sticky' уже создает эффект наложения.
                // Чтобы усилить его, можно сделать следующее:
                sections.forEach((section, i) => {
                    const rect = section.getBoundingClientRect();
                    const distanceToTop = rect.top; // Расстояние от верха окна до верха секции

                    if (distanceToTop < 0 && distanceToTop > -section.offsetHeight) {
                        // Секция "прокручивается" под текущей верхней sticky секцией
                        // Можно применить scale или translateZ к section (или ее .sectionContent)
                        // Чем больше |distanceToTop|, тем сильнее эффект.
                        // Например, для секции, которая УЖЕ НЕ НА САМОМ ВЕРХУ (i > 0)
                        // и которая сейчас "подъезжает" или "уезжает"
                        
                        // Этот коэффициент определяет, насколько сильно секция будет уменьшаться/смещаться
                        // когда она "уходит" под следующую.
                        const scaleFactor = Math.max(0.8, 1 - Math.abs(distanceToTop) / (section.offsetHeight * 2));
                        const opacityFactor = Math.max(0.5, 1 - Math.abs(distanceToTop) / section.offsetHeight);

                        // Применяем к предыдущим секциям, которые уже "проехали"
                        if (i < getCurrentStickySectionIndex()) {
                           // section.style.transform = `scale(${scaleFactor}) translateZ(${-Math.abs(distanceToTop)/3}px)`;
                           // section.style.opacity = `${opacityFactor}`;
                        } else {
                           // section.style.transform = 'scale(1) translateZ(0px)';
                           // section.style.opacity = '1';
                        }

                    } else if (distanceToTop >= 0) { // Секция еще не достигла верха или находится наверху
                        // section.style.transform = 'scale(1) translateZ(0px)';
                        // section.style.opacity = '1';
                    }

                    // Для эффекта, когда текущая секция "наезжает" на предыдущую,
                    // предыдущие должны уменьшаться.
                    // Это сложная логика, которая требует точного отслеживания, какая секция "главная" (полностью на экране).
                    // CSS 'position: sticky' обрабатывает само наложение.
                    // Дополнительные transform для 3D эффекта лучше делать очень аккуратно.
                });


                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
            }

            function getCurrentStickySectionIndex() {
                let currentIdx = 0;
                sections.forEach((section, index) => {
                    if (section.getBoundingClientRect().top <= 1) { // <=1 чтобы учесть погрешности
                        currentIdx = index;
                    }
                });
                return currentIdx;
            }


            window.addEventListener('scroll', handleScroll);
            handleScroll(); // Первоначальный вызов для установки состояний

            // Мобильное меню
            menuToggle.addEventListener('click', () => {
                mainNav.classList.toggle('isActive');
                const icon = menuToggle.querySelector('i');
                if (mainNav.classList.contains('isActive')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                    header.style.backgroundColor = 'rgba(18, 18, 18, 0.95)'; // Чтобы меню не было прозрачным
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                    // Возвращаем прозрачность хедера в зависимости от скролла
                    if (window.pageYOffset <= 50) {
                         header.style.backgroundColor = 'rgba(18, 18, 18, 0.8)';
                    }
                }
            });
            
            // Закрытие мобильного меню при клике на ссылку
            mainNav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    if (mainNav.classList.contains('isActive')) {
                        mainNav.classList.remove('isActive');
                        menuToggle.querySelector('i').classList.remove('fa-times');
                        menuToggle.querySelector('i').classList.add('fa-bars');
                         if (window.pageYOffset <= 50) {
                             header.style.backgroundColor = 'rgba(18, 18, 18, 0.8)';
                        }
                    }
                });
            });

            // Плавная прокрутка для якорных ссылок (если scroll-behavior: smooth не везде работает)
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    // Проверяем, что это действительно якорная ссылка на элемент на странице
                    if (href.length > 1 && document.querySelector(href)) {
                        e.preventDefault();
                        document.querySelector(href).scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Управление выпадающими меню (для доступности и если JS нужен для анимации)
            // CSS :hover уже обрабатывает это, но JS может дать больше контроля
            dropdowns.forEach(dropdown => {
                const link = dropdown.querySelector('a'); // Первая ссылка, которая триггерит
                link.addEventListener('click', function(e) {
                    // Если у ссылки есть href="#" или она ведет на эту же страницу,
                    // предотвращаем переход, чтобы открыть/закрыть меню.
                    // Если это ссылка на секцию, то пусть переход сработает.
                    if (this.getAttribute('href') === '#' || this.parentElement.classList.contains('hasDropdown')) {
                         if (window.innerWidth <= 768) { // Только на мобильных, где :hover может не работать как надо
                            e.preventDefault();
                            // Просто переключаем класс open, остальное сделает CSS
                            this.parentElement.classList.toggle('open');
                         }
                    }
                });
            });

        });
    </script>

</body>
</html>
